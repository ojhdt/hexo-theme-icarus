---
title: 初次使用 腾讯云 CDN
date: 2020-07-18 07:50:13
categories: "教程"
tags: [CDN]
thumbnail: "https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/cdn.jpg"
toc: true
excerpt: "内容分发网络通过将站点内容发布至遍布全球的海量加速节点，使其用户可就近获取所需内容，避免因网络拥堵、跨运营商、跨地域、跨境等因素带来的网络不稳定、访问延迟高等问题，有效提升下载速度、降低响应时间，提供流畅的用户体验。"
---
身边很多朋友都在使用叉拍云的CDN服务，优势很明显。它不仅提供每月**15GB**的免费CDN流量（HTTP/HTTPS可用），还提供**10GB**的免费存储空间，这一切服务只需要用户加入叉拍云联盟（在网站底部添加一个叉拍云LOGO）就可以免费享受。在国内确实是一个十分诱人的选项。

什么？还有朋友不知道 CDN 是什么：

>**内容分发网络（Content Delivery Network，CDN）** 通过将站点内容发布至遍布全球的海量加速节点，使其用户可就近获取所需内容，避免因网络拥堵、跨运营商、跨地域、跨境等因素带来的网络不稳定、访问延迟高等问题，有效提升下载速度、降低响应时间，提供流畅的用户体验。 

扯远了ヽ( ﾟ▽ﾟ)ノ，这篇文章并不着重介绍叉拍云的CDN。作为国内网络服务提供商巨头之一的腾讯云，CDN的策略有些许不同。腾讯云针对的是全站加速，要求已备案域名，并且资费日结。在使用一段时间之后，我希望通过这篇文章来谈一下使用感受。

### 启用服务

想要启用腾讯云的内容分发网络服务，最关键的条件就是 ICP备案 。域名备案可以选择阿里云的备案系统（租一台6元的虚拟机，再将域名绑定到上面走备案流程），速度较快，一周之内就可通过。另外，腾讯云还会对网页内容进行安全检查，涉及违法犯罪的内容都是不能进行加速的。

首先进行实名认证。想必各位使用腾讯云的朋友都已经认证过了。然后按照指引开通就可以了，不必做过多设置。

点击接入域名。

![实名认证](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/3.png)

![添加域名](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/4.png)

![添加域名](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/9.png)

>- `域名`一项填写你希望加速的域名，如 `*.test.com`
>- `源站地址`一项填写服务器ip，端口可省略
>- `回源协议`一项根据源站协议选择HTTP/HTTPS
>- `回源域名`一项填写加速域名

点击`确认提交`域名接入就顺利完成了。系统会为您自动分配一个以 `.cdn.dnsv1.com` 为后缀的 CNAME 域名。

接下来，访问域名的解析服务控制台，添加一个 CNAME 记录。主机记录 填写子域名（例如需要添加`www.text.com`的解析，只需要在主机记录处填写`www`。如果想添加`text.com`的解析，主机记录填写一个 `@` ），记录值 填写分配的 CNAME 域名，保存。

等待设置生效，CDN服务就配置好了。

如果启用了HTTPS，因CDN加速节点和源站采用了不同的证书，网站会提示安全风险。要解决这一问题，需要向CDN配置证书。点击`证书管理`中的`配置证书`,选择加速域名，再输入与源站相同的证书及私钥。如果证书本身是在腾讯云申请的，还可以直接点击`腾讯云托管证书`进行选择。回源协议选择HTTPS，保存即可。

![SSL证书](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/5.png)

资费方面，服务提供带宽计费和流量计费两种。一般办博客使用流量计费就足够了（反正也没多少流量），以本站流量水平一个月也就几毛钱。值得注意的是，计费是按日计算，因此账号里要预先充值好一定金额。

![资费](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/1.png)

>其他详细的相关说明请参阅[文档](https://cloud.tencent.com/document/product/228)。

### 安全设置
由于CDN按量计费，遭受网络攻击可能会为站长带来经济损失。因此，启用CDN服务后，进行安全设置是必须的。

进入`域名管理`，点击对应加速域名的`管理`按钮。

点击`访问控制`，可以设置防盗链，IP黑白名单，下行限速等。其中个人认为比较有用的是`IP访问限频配置`，设置为50QPS就差不多了。

![IP访问限频](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/7.png)

点击`缓存设置`，在`缓存过期配置`中可设置CDN服务器从源站缓存数据的频率，因为最近经常有更新，所以周期设置为一天。各位也可根据实际情况进行修改。

![缓存周期](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/8.png)

点击`高级设置`，设置带宽封顶。当在5分钟的统计周期内带宽达到阈值，CDN就可以直接指向源站或返回404。

进入`云监控-告警管理-告警配置-告警策略`，为CDN流量设置告警。配置好后，当流量达到设定好的阈值，腾讯云就会以短信，邮件，电话等形式发出警示。

![告警设置](https://ojhdt-1257115336.cos.ap-guangzhou.myqcloud.com/img/20200718/2.png)

### 效果

使用CDN能够适应不同网络环境下的网站访问，从而大大提高在某些场合的访问速度。

对源站和CDN分别进行测速，CDN站的响应速度都能在50ms以内。

但在与其他CDN提供商的对比中，腾讯云并没有什么特色，但服务还是可以的。如果手头上有已备案的域名，也能够接受这个资费水平的话，腾讯云 CDN 还是一个不错的选择。